<!DOCTYPE html>
<html>
<body>  
    <?php
  $botSecret = '6l8Zkh8PKxE.h8sUbwmv7cZeFRW7-pdetVHLU6yoeONDx9Fa9Bl1NL4';
  $response = wp_remote_get( 'https://webchat.botframework.com/api/tokens', array( 'headers' => 'Authorization: BotConnector ' . $botSecret ) );
  if( is_array($response) ) {
    $header = $response['headers'];
    $token = $response['body'];
  }
  ?>
  <iframe src='https://webchat.botframework.com/embed/PLM-Info-Bot?t='  style='min-width: 400px; width: 100%; min-height: 500px;'></iframe>
</body>
<script>
    var webChatToken = <?php echo $token; ?>;
    var xhr = new XMLHttpRequest();
    xhr.open('GET', "https://webchat.botframework.com/api/tokens", true);
    xhr.setRequestHeader('Authorization', 'BotConnector ' + 'webChatToken');
    xhr.send();
    xhr.onreadystatechange = processRequest;

    function processRequest(e) {
      if (xhr.readyState == 4  && xhr.status == 200) {
        var response = JSON.parse(xhr.responseText);
        document.getElementById("chat").src="https://webchat.botframework.com/embed/PLM-Info-Bot-Dev?t="+response
      }
    }

  </script>
</html>
